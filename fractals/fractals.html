<DOCTYPE html>
<html>

<head>
<title>Fractals</title>
</head>

<body>

<canvas id="myCanvas" width="1000" height="1000">
</canvas>

<script type="text/javascript">
  function square(num) { return num * num; }
  var canvas = document.getElementById("myCanvas");
  var canv = canvas.getContext("2d");
  canv.fillStyle = 'rgba(0, 0, 255, 1)';
  var allTheLines = [];
  var levelsOfDepth = 0;

  class Line {
    constructor(firstX, firstY, secondX, secondY) {
      this.firstX = firstX;
      this.firstY = firstY;
      this.secondX = secondX;
      this.secondY = secondY;
    }
    setMagnitudeAndAngle() {
      this.magnitude = Math.sqrt(square(this.secondX - this.firstX) + square(this.secondY - this.firstY));
      this.angle = Math.atan((this.secondY - this.firstY) / (this.secondX - this.firstX));
    }
    draw() {
      canv.lineWidth = 0.01 * this.length + 5;  // draw line slightly thicker if the line is longer
      canv.moveTo(this.firstX, this.firstY);
      canv.lineTo(this.secondX, this.secondY);
      canv.stroke();
    }
  }

  function becomeMoreLines() {
    var newLines = [];
    for (var i = 0; i < allTheLines.length; i++) {
      allTheLines[i].setMagnitudeAndAngle();
      var angle = allTheLines[i].angle + (Math.pi / 3);
      var magnitude = allTheLines[i].magnitude * 1;
      var firstX = allTheLines[i].firstX;
      var firstY = allTheLines[i].firstY;
      var secondX = firstX + (magnitude * Math.cos(angle));
      var secondY = firstY + (magnitude * Math.sin(angle));
      var nextLine = new Line(firstX, firstY, secondX, secondY);
      newLines.push(nextLine);

      console.log(firstX, firstY, secondX, secondY, magnitude, angle, allTheLines.length);

      allTheLines[i].setMagnitudeAndAngle();
      angle = allTheLines[i].angle - (Math.pi / 3);
      magnitude = allTheLines[i].magnitude * 1;
      firstX = secondX;
      firstY = secondY;
      secondX = firstX + (magnitude * Math.cos(angle));
      secondY = firstY + (magnitude * Math.sin(angle));
      nextLine = new Line(firstX, firstY, secondX, secondY);
      newLines.push(nextLine);
    }
    return newLines;
  }

  var firstLine = new Line(100, 100, 500, 100);
  allTheLines.push(firstLine);
  for (var i = 0; i < allTheLines.length; i++) {
    allTheLines[i].draw();
  }
  allTheLines = becomeMoreLines();
  for (var i = 0; i < allTheLines.length; i++) {
    allTheLines[i].draw();
  }
  allTheLines = becomeMoreLines();

</script>

</body>
</html>
